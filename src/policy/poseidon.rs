use dusk_plonk::prelude::BlsScalar;

const ARITY: usize = 2;
pub const WIDTH: usize = ARITY + 1;
const FULL_ROUNDS: usize = 8;
const PARTIAL_ROUNDS: usize = 55;
const HALF_FULL_ROUNDS: usize = FULL_ROUNDS / 2;
const DOMAIN_TAG: u64 = (1u64 << ARITY) - 1;
const DOMAIN_TAG_SCALAR: BlsScalar = BlsScalar::from_raw([DOMAIN_TAG, 0, 0, 0]);

const MDS: [[BlsScalar; WIDTH]; WIDTH] = [
    [
        BlsScalar::from_raw([
            0xaaaaaaaa00000001,
            0xe27e6d5755543d54,
            0xccd13ab0066be558,
            0x4d491a377113a8da,
        ]),
        BlsScalar::from_raw([
            0x3fffffff40000001,
            0xfece3b023ffec4ff,
            0x266b620607396203,
            0x56f23d7e5f361df6,
        ]),
        BlsScalar::from_raw([
            0xcccccccc33333334,
            0x323e959b66656a65,
            0x51ef819e6c2de803,
            0x458e97984c2b4b2b,
        ]),
    ],
    [
        BlsScalar::from_raw([
            0x3fffffff40000001,
            0xfece3b023ffec4ff,
            0x266b620607396203,
            0x56f23d7e5f361df6,
        ]),
        BlsScalar::from_raw([
            0xcccccccc33333334,
            0x323e959b66656a65,
            0x51ef819e6c2de803,
            0x458e97984c2b4b2b,
        ]),
        BlsScalar::from_raw([
            0xd555555480000001,
            0x1b1e08ad2aa94ca9,
            0x8005895c0806deaf,
            0x609b60c54d589311,
        ]),
    ],
    [
        BlsScalar::from_raw([
            0xcccccccc33333334,
            0x323e959b66656a65,
            0x51ef819e6c2de803,
            0x458e97984c2b4b2b,
        ]),
        BlsScalar::from_raw([
            0xd555555480000001,
            0x1b1e08ad2aa94ca9,
            0x8005895c0806deaf,
            0x609b60c54d589311,
        ]),
        BlsScalar::from_raw([
            0xdb6db6db24924925,
            0xaa362edc49241a48,
            0x57c7624b7077624a,
            0x211f5460e7519182,
        ]),
    ],
];

const ROUND_CONSTANTS: [BlsScalar; 189] = [
    BlsScalar::from_raw([
        0x85659c9a6e1b9b31,
        0x58cd65ed9cc80ef9,
        0xc3726c767ca2b05,
        0x6d1815e9a2ef21fa,
    ]),
    BlsScalar::from_raw([
        0x26ce570ff8dc34a9,
        0xbe673cca84fbe943,
        0xef000f0c25743e81,
        0x4be1f7d142e3c363,
    ]),
    BlsScalar::from_raw([
        0x19f9ac45fa572c9b,
        0x2bd7ba9820072c5f,
        0x5e2631bfd4c4524,
        0x56fde02d9f4ddeaa,
    ]),
    BlsScalar::from_raw([
        0xb3eaf9f2fa510ef1,
        0x88349e9ca035f215,
        0x6af47aa0d62739ba,
        0x284b7109cac46ee2,
    ]),
    BlsScalar::from_raw([
        0x6f50af88032c3d0f,
        0x9cd3bdbc2d2b7cd5,
        0x21ab0b1b3db1f666,
        0x5f3345c3ac4c3b9c,
    ]),
    BlsScalar::from_raw([
        0x46f4f41615971320,
        0x1958aaeea860021f,
        0xeb7923d1746302b7,
        0x12d02ab99b1fd76,
    ]),
    BlsScalar::from_raw([
        0x118ca42f92d36087,
        0x7c93c85e59a692b0,
        0x1ecce63e4d066ea5,
        0x6adbad7991861c17,
    ]),
    BlsScalar::from_raw([
        0xfe1f7cedb9f03782,
        0x7c9996a50d91e028,
        0xbb102fa024c2f1c0,
        0x5574b29ae3c4af4f,
    ]),
    BlsScalar::from_raw([
        0xe88cbd65c53643b2,
        0xc81693f1d94ecabc,
        0x4d2437192adc0787,
        0x5b780e33e1eae785,
    ]),
    BlsScalar::from_raw([
        0x12dc5dfaa87825e4,
        0x55c2c573f1549841,
        0x1e117fc3f9b2ab05,
        0x41bb3541893392c,
    ]),
    BlsScalar::from_raw([
        0x3db936eab7896e13,
        0x83da311c229a17da,
        0x6358bc9d2b734a6f,
        0x4e3468fb4bee22f9,
    ]),
    BlsScalar::from_raw([
        0xd704fcf5b682d513,
        0xc2634e5a92206435,
        0x4b65b5d1976048d0,
        0x5a64708275708b80,
    ]),
    BlsScalar::from_raw([
        0xa7cc98592e954088,
        0x7d976387452fe3ee,
        0xb1f78b06595b3b8b,
        0x3b06b4cb84b7a5cf,
    ]),
    BlsScalar::from_raw([
        0xf73ca1f372e1cde0,
        0x466399c3f43343ef,
        0x4ac6a98239365354,
        0x5a5f66b3e08846eb,
    ]),
    BlsScalar::from_raw([
        0xb47188858218542,
        0x9dc80a3132971e38,
        0x754cfb8291cdd17b,
        0x6a58baade910f0ee,
    ]),
    BlsScalar::from_raw([
        0xd4f7c4fd00aa70ce,
        0x5927f175a2f7cfe7,
        0x63e2f5b8ee1422d6,
        0x49e1e8c6e2aa1061,
    ]),
    BlsScalar::from_raw([
        0x565f8e8a12df6b4c,
        0xdee004a9cbe55c9a,
        0x84a7ea535622742f,
        0x738a3edc28d8758,
    ]),
    BlsScalar::from_raw([
        0x4cf1955ddb0cdd4b,
        0x719a058f697e4f65,
        0x4b27a9a843f7f6fd,
        0x57077b0cdf6d52ca,
    ]),
    BlsScalar::from_raw([
        0x7a2b8772c3535dd7,
        0xc711767858fbe35b,
        0xc06809560ad1b7fd,
        0xe57b216387c9808,
    ]),
    BlsScalar::from_raw([
        0x4bdd11ca21ea1deb,
        0x381e594c51c02de8,
        0xa5c165e4872dd76a,
        0x60536c999a8d9bfa,
    ]),
    BlsScalar::from_raw([
        0xf1534b3a3a811ad0,
        0x103f8e6db111dea8,
        0x521cdc0e09ad0a32,
        0x41a51d617c707b77,
    ]),
    BlsScalar::from_raw([
        0x5f14be3c001d6135,
        0xe4b908b6127089cc,
        0xcdf1082865ee26fc,
        0x4e9c9f6fe56318ca,
    ]),
    BlsScalar::from_raw([
        0x541eea09af12b77f,
        0xd23e2f2c83778bb6,
        0xadba91bf6ee9b35d,
        0x60203e8d2e91ce2c,
    ]),
    BlsScalar::from_raw([
        0xe0d3f230681fa47e,
        0x286f6a6aa3bb2b84,
        0x4bb2893bf2980fb3,
        0x23de2306726e66a6,
    ]),
    BlsScalar::from_raw([
        0xeef589bf1ce6400a,
        0x9b1bd7a0b2389cbe,
        0xf4ba36c316e999b7,
        0x361fac020e031c21,
    ]),
    BlsScalar::from_raw([
        0x1007c53d72d6cdda,
        0x77ca2fcf29dbc0f0,
        0x1c9f1b34e0e00435,
        0x257bcf84370bf29a,
    ]),
    BlsScalar::from_raw([
        0x3af3e35f4228db8a,
        0x96aadae6cf3b5056,
        0x7ae67b6ac2e6d50f,
        0x7246dd2dde09c1dc,
    ]),
    BlsScalar::from_raw([
        0xf00d4f7d438bd837,
        0x28036fdc5d7f69f7,
        0x7fe6888d46f4e68,
        0x22e3276241ddd45f,
    ]),
    BlsScalar::from_raw([
        0x69411bca9fb0b3c2,
        0xfc927f6008258a1a,
        0xd8ac03b4e8e128a1,
        0x48b54dd15fdd38f4,
    ]),
    BlsScalar::from_raw([
        0x75c4f9e4715715c1,
        0x63aa29d4c30e3cf0,
        0xa9d14778b062aeaf,
        0x2fb5a020e218bf45,
    ]),
    BlsScalar::from_raw([
        0xa1b17361e23643c4,
        0x7b1eb86739ec2d46,
        0x3a0faa4e5f3bde61,
        0x12b35c1809efc369,
    ]),
    BlsScalar::from_raw([
        0xea7b34dce75bb189,
        0x1056ac20110f7703,
        0xff00e5e974340bc6,
        0x42c49f03af9faa16,
    ]),
    BlsScalar::from_raw([
        0xaefab11ed8c1995b,
        0x5bfc24e14091115b,
        0xbcefcd09d328e372,
        0x5862ca1681b46110,
    ]),
    BlsScalar::from_raw([
        0x41b769fdcabefcce,
        0xf5ebf7b1e097d6f4,
        0x9deb1ead092a381d,
        0x3f22fad8f3b118ba,
    ]),
    BlsScalar::from_raw([
        0xf7f7952dc819a550,
        0x50914e45a654f949,
        0x633c17d12143b2c5,
        0x18113155e2d0caba,
    ]),
    BlsScalar::from_raw([
        0x5e06f2b627943820,
        0x627e0291dbee157f,
        0xd84c4e59e36256cb,
        0x59e5726460409181,
    ]),
    BlsScalar::from_raw([
        0xd48a31204cd2b111,
        0x2af2cd1a4b013904,
        0x6795bcd2ea13710d,
        0x47d11254cd2d1d6e,
    ]),
    BlsScalar::from_raw([
        0xc6c1e321951f2e3f,
        0xd3344393b5358730,
        0x63db00fb86e30f14,
        0x1607b022626b8b6a,
    ]),
    BlsScalar::from_raw([
        0x798221280bd4911a,
        0xffa3e9d66b1a145c,
        0x7cf5c32f5f67cf2c,
        0x227d1f695d3396c4,
    ]),
    BlsScalar::from_raw([
        0xa797410b3c242a10,
        0xefe46aa4a40bcda7,
        0xd08fe73732b2f033,
        0x2a20044b3a957c76,
    ]),
    BlsScalar::from_raw([
        0x2c6285c7909500fb,
        0x31ffb88636ab64d4,
        0x627fa034b20a9269,
        0x6c330f0a32190828,
    ]),
    BlsScalar::from_raw([
        0x11da71bf1cde04e5,
        0x953449639f06da3,
        0x27ad90b07a2a163a,
        0x209268cc97e98f4c,
    ]),
    BlsScalar::from_raw([
        0x608fe7fcb8f7151b,
        0xa2f2582b803c1083,
        0xf5fa458ec93f5dba,
        0x19e993d1238f4cb7,
    ]),
    BlsScalar::from_raw([
        0xe38bbe9e8c0a715,
        0x4e3498a2e06dd33c,
        0xe92fe197fab5d25f,
        0x6c43e9604f17ccf3,
    ]),
    BlsScalar::from_raw([
        0x9c126283bb00f997,
        0x102f2b1fb4f0e3bc,
        0x2f34370076e3fdb3,
        0x4c41fa2f1064b3f1,
    ]),
    BlsScalar::from_raw([
        0xcb3e0bffc9588b75,
        0xc1c55778d6da8c88,
        0x38af7b3ed16c8fdd,
        0x70e581e241940f33,
    ]),
    BlsScalar::from_raw([
        0x62242f4c09ebad02,
        0xec15921efd532553,
        0x607544110cdae398,
        0x241e8717294c7738,
    ]),
    BlsScalar::from_raw([
        0x3f72ce772cdf3a45,
        0xf39412c3664a18ef,
        0xae1878c726fd7327,
        0x73824149fcea9c45,
    ]),
    BlsScalar::from_raw([
        0xb80fdeca44b0d79b,
        0x8906bdf2d4abdb67,
        0x635136d6beac1619,
        0xbadf954aef39b6,
    ]),
    BlsScalar::from_raw([
        0x6bcb038a881700d5,
        0xef98680a53f76b36,
        0xc5894ff6d24d2296,
        0x12a687e93b2bfd0b,
    ]),
    BlsScalar::from_raw([
        0xee72f41458e7d76d,
        0x61c4d149ee8d5d2e,
        0xa75d6a630bd11d72,
        0x229e85709354498f,
    ]),
    BlsScalar::from_raw([
        0x78886ad5a1b50971,
        0x73431bd44a3af7ba,
        0x4e5d2da52077d920,
        0xb1d0b167dc6ac8d,
    ]),
    BlsScalar::from_raw([
        0xed91a1b35c757910,
        0x487adfe9c6e9abb3,
        0x4c2336c933f1519e,
        0x32929f387b4f9459,
    ]),
    BlsScalar::from_raw([
        0x73321812d6c72b82,
        0x9b93246aa9a57726,
        0x12ec48ead5f37f93,
        0x26df4f72e93524b0,
    ]),
    BlsScalar::from_raw([
        0x89dda441607b1f6f,
        0x4497022c070b9f3d,
        0xb0480f94af209147,
        0x228c75c2b3ba5c41,
    ]),
    BlsScalar::from_raw([
        0x44d30b2b9c0c1b88,
        0x1eadde5b865f0d48,
        0x998a00c0587da5bc,
        0x3f4c86697c76d4b2,
    ]),
    BlsScalar::from_raw([
        0x9d9f6cbd2f92d0fe,
        0xed27404445f2df1b,
        0x50ead8d3c6b750a3,
        0x1046f4d549740d66,
    ]),
    BlsScalar::from_raw([
        0x973a9ae89802b124,
        0x5c588e33db37b838,
        0x8f94455649836d3c,
        0x108cd3320eff9958,
    ]),
    BlsScalar::from_raw([
        0xe9e507150fe7d69c,
        0xac0616645e30a6ab,
        0xe3fdc2179a70b210,
        0x6bc3bf3505b8d25c,
    ]),
    BlsScalar::from_raw([
        0x2bee6f9f13336277,
        0x941dce4155ecf7f0,
        0xbe661230e93af957,
        0x2cb2d4bdd34b830a,
    ]),
    BlsScalar::from_raw([
        0x55587c188153a887,
        0x113a81c1a53f3db5,
        0xf60ce77db4301156,
        0x3dd0a0a898c413d,
    ]),
    BlsScalar::from_raw([
        0xcf1bc9c0554a4122,
        0x4b954174de89b430,
        0xab9dcc17c01ca02a,
        0x704d554295d94567,
    ]),
    BlsScalar::from_raw([
        0x751f3606792e16ac,
        0xc99bf41282ab7c7d,
        0x790c074748755a87,
        0x432554646915a608,
    ]),
    BlsScalar::from_raw([
        0x7f9ffba4995e466f,
        0x9175536e91e5f6b5,
        0xf05d040b0ae24539,
        0x3c3b59519faa9b2e,
    ]),
    BlsScalar::from_raw([
        0x4abbddbf339a0022,
        0x4824863a703be942,
        0x424e4ff8b4b2bad4,
        0x6b752f20200f5c28,
    ]),
    BlsScalar::from_raw([
        0x2ef4236f51b427e2,
        0xdec5a2c6bf24a4d5,
        0x332220b9135cd59,
        0x283d1d0e88384951,
    ]),
    BlsScalar::from_raw([
        0x5b7e0b3531fb2980,
        0x1afe8e3e3cd95e4a,
        0xdc0b41e73135d43d,
        0x71845060a6aa6202,
    ]),
    BlsScalar::from_raw([
        0xd187ccaba9ec737f,
        0xea8032d3d62fe948,
        0xc7a1145cb8baa32d,
        0x3d11b16f3672f52a,
    ]),
    BlsScalar::from_raw([
        0xbaabc86ad84e39cd,
        0x1437d8c548d104a4,
        0xd65de2b6e6769ebe,
        0x3f2e4bfe1fc8e8e1,
    ]),
    BlsScalar::from_raw([
        0x9cd16dfe3f048235,
        0x89571efd8ea531bd,
        0x57443da3937bdb49,
        0x1c6b69c3e7174194,
    ]),
    BlsScalar::from_raw([
        0x171f0fe34a4c0c86,
        0x6c9ad1c827a2b0c7,
        0xcca5691d7bf8a00b,
        0x3bd94b079b394e1c,
    ]),
    BlsScalar::from_raw([
        0x366afbd4f89f7693,
        0x9694a807616edc2a,
        0x7c65faffa36b3cb,
        0x555d3dffb67bd138,
    ]),
    BlsScalar::from_raw([
        0x7f8f247e7ec553d0,
        0xf466e82523405673,
        0x592ca0bc7460499b,
        0x51436d2e74d0a49d,
    ]),
    BlsScalar::from_raw([
        0xeef563f3f70c5e00,
        0x3b41bba4dbba8f7e,
        0xe6a82aa11090f38b,
        0x5dd6853f8b562aca,
    ]),
    BlsScalar::from_raw([
        0x1de401f90b1bcbc1,
        0xc881040a6d624462,
        0xa9222f7ef0c5f035,
        0x91fd529f0b7ec73,
    ]),
    BlsScalar::from_raw([
        0xc44acf172f1474ef,
        0x1f1e115650b7d5ce,
        0x74e29943ebde115e,
        0x1b873c30d4f472a0,
    ]),
    BlsScalar::from_raw([
        0x60116262eded7114,
        0xd3660b4b1f3fc4ee,
        0x3402321392079e42,
        0x2c509066d0425500,
    ]),
    BlsScalar::from_raw([
        0x49120152cffdfe24,
        0x8af12a1ea146884b,
        0x8661dc57c80033ad,
        0x260e68dc70ec394e,
    ]),
    BlsScalar::from_raw([
        0x79e90c76d49a5e0c,
        0x8d74267e486aea81,
        0x93469117e9cd1d93,
        0x6b4c8da2112abfdf,
    ]),
    BlsScalar::from_raw([
        0xaf696f649c9a895c,
        0xee214c35dcb75f2e,
        0xbe684ceba68a87b5,
        0x258ce4bed884e84e,
    ]),
    BlsScalar::from_raw([
        0xd345073408ccb300,
        0x2d4bc81479a6b96e,
        0x4a1f7468968ff7e5,
        0x8a1b3dd07cf1915,
    ]),
    BlsScalar::from_raw([
        0x14f30239e2ffaa42,
        0xb7fee5fa3bb78141,
        0x1850325ad3a70280,
        0x3f079cd9663205ab,
    ]),
    BlsScalar::from_raw([
        0x362bef8b5643c0e5,
        0xb24a1cfe17741042,
        0x542084a270373d81,
        0x305e1e2053534b9,
    ]),
    BlsScalar::from_raw([
        0xd31ae6ce41991508,
        0x5a2c97adfc6b433c,
        0x7fb032903f584669,
        0x511e4f6ecfa4872d,
    ]),
    BlsScalar::from_raw([
        0xa621e3fbcd1090cc,
        0x88edee58cb943595,
        0x5ca13f90dad704f7,
        0x720766a85b41cab7,
    ]),
    BlsScalar::from_raw([
        0x50e737dc679e9cc8,
        0x7e41347178ff5fe5,
        0xcc09552bb342c5a7,
        0x374b417b97b636f2,
    ]),
    BlsScalar::from_raw([
        0x9e28aa988ea813a1,
        0xe28631df9c0da518,
        0xd0683e4b778ddf5,
        0x1da919b0891d318b,
    ]),
    BlsScalar::from_raw([
        0x56c5b364e51b0aab,
        0xd0f6ff0c57deb344,
        0xe0bb9884ba0c3ad3,
        0x2876e1b522c44d53,
    ]),
    BlsScalar::from_raw([
        0xf256b24cf764dfe6,
        0x19ce11cc0b29f073,
        0xff18156cda138643,
        0x415397d7ac67ac56,
    ]),
    BlsScalar::from_raw([
        0xf282326f26066051,
        0x74a82fac81043e5,
        0x976fea89c95edcbf,
        0x6ba2ec7cb59af8ef,
    ]),
    BlsScalar::from_raw([
        0xeffb13291a9361ee,
        0x1936a738ca18c1b0,
        0xdf6391027347f988,
        0x30b48632f2368510,
    ]),
    BlsScalar::from_raw([
        0x2699b29fc01957d4,
        0xa26eb9b9df5ba1f7,
        0x10adf7a32d8e341,
        0x2989cfba6da38a1a,
    ]),
    BlsScalar::from_raw([
        0x86f647135ef097e1,
        0xe45a0e0751c876b8,
        0x7e6e3be66f5827fc,
        0x70a6b73c19c33d9e,
    ]),
    BlsScalar::from_raw([
        0xf18fa583426c0c6f,
        0xe1d3e7ccc16e6bfe,
        0xdb7dc6de9e0471bc,
        0x12107dfc75dbf364,
    ]),
    BlsScalar::from_raw([
        0x474afe976168a267,
        0x34f691844779590a,
        0x2f185727be9914f4,
        0x4c5e917c8e184b7a,
    ]),
    BlsScalar::from_raw([
        0x1aa98c68123e7ff9,
        0xac21801c858f0a9f,
        0x81952cc857d3e660,
        0x3119f50e138242e9,
    ]),
    BlsScalar::from_raw([
        0xdc23ea3ee0bf7ffa,
        0x238d64a2ea7973a7,
        0x7d10520c8e87d6f2,
        0x48ae36019b5e003e,
    ]),
    BlsScalar::from_raw([
        0x288b2e53becee1d4,
        0x8674dc5c83174f8e,
        0xd40af4b988d574da,
        0x269793e397097ae7,
    ]),
    BlsScalar::from_raw([
        0xf5be4db65deb785b,
        0xf38d3b89a9b7e588,
        0xf9de9f040aefb1c9,
        0x4d9ea1a69f426d1a,
    ]),
    BlsScalar::from_raw([
        0x8b2abc9fc996874c,
        0x999737f21df1834c,
        0x388fa1dbb6fb02bc,
        0x1a44004ffaba26f5,
    ]),
    BlsScalar::from_raw([
        0x9a4c53c7cd668b9,
        0xf4cf5d6a3a817b6,
        0x9513d240dafa896a,
        0x6a2c723984f3ed0e,
    ]),
    BlsScalar::from_raw([
        0x40f5ff6a37d7fa16,
        0xd81bba8cffc490fa,
        0x2ce4cdf223d38fd8,
        0x57981114a217e774,
    ]),
    BlsScalar::from_raw([
        0x827f7a951d2c7a6a,
        0x1a9e78ab87e1377b,
        0xf95f8080a0f934c3,
        0x49414695116def10,
    ]),
    BlsScalar::from_raw([
        0x7a62d960f95c5013,
        0x43e6bb189417b3be,
        0xe1a27255e82832a9,
        0x1b4158009f89870f,
    ]),
    BlsScalar::from_raw([
        0x6bbf41e02d44294d,
        0x5413a78c2782f56b,
        0x9950c313227e61f1,
        0x4c12043d9cddc873,
    ]),
    BlsScalar::from_raw([
        0x3c9e62ef17c8e692,
        0xd42047307ae6b2e8,
        0xfc276276cbeaa2a5,
        0x694cd7b45583c56b,
    ]),
    BlsScalar::from_raw([
        0xfd4639c0dbb9328c,
        0xd88d7bae6660d72b,
        0xe4cb9afbf0c4b24,
        0x6100ead79ab9fece,
    ]),
    BlsScalar::from_raw([
        0xfbf123b9f5281aab,
        0xab78b2d190d5d0ea,
        0xc1f9e9c5be3738bc,
        0xe4dcc06be2bf6ce,
    ]),
    BlsScalar::from_raw([
        0x4f27fa4f24d46dbb,
        0x11e02f89ecc96c7b,
        0x2a2888963360330d,
        0x5379b65f7c631330,
    ]),
    BlsScalar::from_raw([
        0x71c354f38c262e32,
        0xba52df67bfaf5871,
        0x18bb605e2265b56c,
        0x5623d41bef973d16,
    ]),
    BlsScalar::from_raw([
        0xfc9fd4643c063968,
        0x79a4fe723c457446,
        0x68ef7fd2ef8f8558,
        0x51f4a9d35bfd1bfa,
    ]),
    BlsScalar::from_raw([
        0x165dc5ab59cb22cb,
        0x14b2987f92ff4751,
        0xdd92bae07c3c1263,
        0x2a62342887924fa4,
    ]),
    BlsScalar::from_raw([
        0x1484661e1dc93c50,
        0x90997c15563bb223,
        0xd296f1ff651a0048,
        0x18b730330d8705c1,
    ]),
    BlsScalar::from_raw([
        0x18d96e288bb5a15e,
        0x319a8f96058c202d,
        0x8c400d65ffed18f0,
        0x72ddc4d5922f2912,
    ]),
    BlsScalar::from_raw([
        0xce68f6023a6bd81c,
        0xbbf23e4efe9e44c4,
        0x436a3046d6244adb,
        0x13fdcb4e45ec08c5,
    ]),
    BlsScalar::from_raw([
        0x54d8b150da9dea1c,
        0x6f08478ffa830725,
        0xf728bf18c44942c,
        0x187a7bdd9772c51a,
    ]),
    BlsScalar::from_raw([
        0xc20ba84408ed57e3,
        0xe0c2aa7704533e0c,
        0x31d9ced8e12b6248,
        0x456e18590dd7cbcd,
    ]),
    BlsScalar::from_raw([
        0x1524ce92a34eb074,
        0xd1bbe43a77027b92,
        0x3e3a0543799db197,
        0x5143a7e5d1e37a3b,
    ]),
    BlsScalar::from_raw([
        0x2c242c297b85c222,
        0xc42a04f1ab9d365e,
        0xf1acd327a5c0e036,
        0x31e9c4c62add83f3,
    ]),
    BlsScalar::from_raw([
        0xd8fe2182123d275b,
        0xc67fdb2d3b1a19e2,
        0xb56b21ac1d6f3096,
        0x73da555ff08885cb,
    ]),
    BlsScalar::from_raw([
        0xc559cf0e6f319af6,
        0x5a1f1c2e76a9e26c,
        0x79baee64ef1a2957,
        0x1e10c4525b5ea170,
    ]),
    BlsScalar::from_raw([
        0xd0cef3686909749e,
        0x3dc045a26163c98f,
        0x491be8eabe4cf3e0,
        0x1962e067e8069a42,
    ]),
    BlsScalar::from_raw([
        0x248291a76e5a2f33,
        0x1f993b5e98dde0b4,
        0xb33629538821d44c,
        0x1fa80588045c936f,
    ]),
    BlsScalar::from_raw([
        0x14c8ca47a1e1bf42,
        0x8516b2e7b12930dc,
        0x13620cc45af2bf58,
        0xe3d3ed1738ab538,
    ]),
    BlsScalar::from_raw([
        0xff0b56745eda15b0,
        0x7a45ddeb9ed61f50,
        0xba49558c9b502949,
        0x14388c389b65d715,
    ]),
    BlsScalar::from_raw([
        0xf9a4f3c6f6b8eb4e,
        0xaa2bf54fcd4acd61,
        0x7a7d19c0f035f468,
        0x53e8eef323b78c64,
    ]),
    BlsScalar::from_raw([
        0xcd53201ad3766c01,
        0xc651be98a9aa30d0,
        0x7676fbc133ed0734,
        0x50b2080073ea49eb,
    ]),
    BlsScalar::from_raw([
        0x646a5a6ab939afd2,
        0xc8297d5ae9783943,
        0x887e43ff9ab5b042,
        0x2243a79ba0cfe573,
    ]),
    BlsScalar::from_raw([
        0xc605d910a7c6d08e,
        0xbe305a51e290ddca,
        0xccb92857771c7bd7,
        0x38d5d727f9d21f81,
    ]),
    BlsScalar::from_raw([
        0xf2ddb8b6aae81041,
        0xf7ec0a90c461a957,
        0xff51a6cbdc5aa691,
        0x3908cd8eaf6c60,
    ]),
    BlsScalar::from_raw([
        0x2fe880992fc74210,
        0xb8e903e30fd5f5fb,
        0x574a6f0b83af6b26,
        0x72ba4f4565af2ae,
    ]),
    BlsScalar::from_raw([
        0x3aacf0eb4df26948,
        0xe5463672a79b126,
        0x6dae219b9fc853ba,
        0x44da68b850217ad8,
    ]),
    BlsScalar::from_raw([
        0x1f061f5d1ed4467f,
        0x9dc2782c173e3ec2,
        0x3fcdd95050cda686,
        0x3c0102a09371c5bf,
    ]),
    BlsScalar::from_raw([
        0xefbf32db6bda51ef,
        0x4e2de46ab1a76c3c,
        0x79d06db2b03a31cb,
        0x5757621cdf3c5ec4,
    ]),
    BlsScalar::from_raw([
        0x64c65e3055c8bddd,
        0x46bfa6e615f51a9c,
        0x82c56aa09c430a56,
        0x3dc880bb1ffbe198,
    ]),
    BlsScalar::from_raw([
        0xe02200a563e19959,
        0xe219bc2e2b05dab4,
        0x8411b8a196a77be8,
        0x22d58a5186dcc37f,
    ]),
    BlsScalar::from_raw([
        0xbaff1bb3efd9b2a1,
        0x1759477ecd2e94ae,
        0x3f87e869958f3bd3,
        0x64b07d028ec08478,
    ]),
    BlsScalar::from_raw([
        0x58bed6c81604d6f6,
        0x36e91d5c96e5d78b,
        0xa9a17cde1f6f3fc3,
        0x6d0b9c4067731143,
    ]),
    BlsScalar::from_raw([
        0x5c8293388765f001,
        0xc680e6d07734595,
        0x9ce15c0031793a0b,
        0x43cf9b109b79f19e,
    ]),
    BlsScalar::from_raw([
        0x988c681a12c01cba,
        0x651a0d6cdceea8f1,
        0x3aeb8049fb314c,
        0x6ff94cd983411b79,
    ]),
    BlsScalar::from_raw([
        0x5389939337fe0186,
        0xf164a1eef380c009,
        0x1432d41798526a46,
        0x2507fe2428ddd0b9,
    ]),
    BlsScalar::from_raw([
        0xd47a13402ba408ba,
        0xc3bdf1ba5f95b906,
        0x6668461397416b72,
        0x4e159c8e6a09fbbc,
    ]),
    BlsScalar::from_raw([
        0x4988d3f524fb99cf,
        0xad0a51bceb461059,
        0x49bc120f5d5173c9,
        0x35e0eab9ee62d911,
    ]),
    BlsScalar::from_raw([
        0x5f73e4f82d8f7833,
        0x26d1b567f3bb88ca,
        0x6c5763ce9b275ecf,
        0x2f160dcbf44f81bb,
    ]),
    BlsScalar::from_raw([
        0x64baf7e9b2b4410e,
        0xed99f8d26498ffe6,
        0x4590bb13ad6ec08b,
        0x3c737f2e06dcff29,
    ]),
    BlsScalar::from_raw([
        0x263e9da2cdeffece,
        0xa7cbc982abef71f9,
        0xacece060bce0543a,
        0x1706efe7c1265955,
    ]),
    BlsScalar::from_raw([
        0xa20d931b6ee90e6f,
        0xda0088646d6f0927,
        0x24a7b8482ef06e2a,
        0x5e62196ff2367579,
    ]),
    BlsScalar::from_raw([
        0x438e3243ecdd02ba,
        0x74a8d698ef661e,
        0xa11bb635c5a7964b,
        0x657c4f20da9c8172,
    ]),
    BlsScalar::from_raw([
        0xa651792444f86ab,
        0x4acda76fa835a56d,
        0xef06a982dbc18824,
        0x40e5dec62c39fa5a,
    ]),
    BlsScalar::from_raw([
        0xdec13ef4080a7441,
        0xedbae3e97bb751b3,
        0x1090724c16b376db,
        0x34a70c4d15b2a907,
    ]),
    BlsScalar::from_raw([
        0xdad28202fb63c5cf,
        0x1a41faa4fb0c30b4,
        0x8858562563f1cca7,
        0x31113bd6f0e3af5f,
    ]),
    BlsScalar::from_raw([
        0x468252f59b1c9f95,
        0x73976f656e4b8d9c,
        0x452966faf36926a0,
        0x4c224eb638265226,
    ]),
    BlsScalar::from_raw([
        0xb64ad914f42e9ef3,
        0x83b76fbb2773a66c,
        0x650e905a3cdcbd02,
        0x6041c53e444a2f6d,
    ]),
    BlsScalar::from_raw([
        0xc38a6f3b7340e41,
        0xb7dc12ae9daa8ea8,
        0x806088b2132802bc,
        0x471ffd7d4b10d749,
    ]),
    BlsScalar::from_raw([
        0x1a9109b814555809,
        0x92db56532e092d9,
        0x5352370798c75f35,
        0x5666f3e02e4be9ab,
    ]),
    BlsScalar::from_raw([
        0x6cb756efb0bbb892,
        0xa8c661a7531ff321,
        0xc3b3c683c91a1e78,
        0x43a42bcd98c7f400,
    ]),
    BlsScalar::from_raw([
        0xab9816b141fe4bb0,
        0x2e0aad9cb641f1df,
        0x41ab7a7d68cb708c,
        0x3f82dba31177d5a7,
    ]),
    BlsScalar::from_raw([
        0xd52f6731bf6f2738,
        0xa1ad468283626ee2,
        0x22910914774f1a4f,
        0x68f17c193e289b25,
    ]),
    BlsScalar::from_raw([
        0x8fa10f119030f90d,
        0x9d4ff81d6a19c9b,
        0x3ef3751e5703a2b7,
        0x37af9bda183dc733,
    ]),
    BlsScalar::from_raw([
        0xc23698cc50840b9e,
        0x8dad1f5ae0e0cb2f,
        0x1c73b8e507df0a04,
        0x6a41abe11774ed89,
    ]),
    BlsScalar::from_raw([
        0xd382f0ee98829465,
        0x21a575d0c319c623,
        0x97b48218a1c710bf,
        0xd852b3aa1511d1,
    ]),
    BlsScalar::from_raw([
        0x6ac28c9ec65aa5fc,
        0x5e0109fd0ad743a3,
        0x1bf4e0140cfd9600,
        0x188ae756931ee307,
    ]),
    BlsScalar::from_raw([
        0x4ffdd1942ee9dba2,
        0x8a956a70bdc169ff,
        0xec53dcf8ace1ab9e,
        0x49e456eaa4ec528e,
    ]),
    BlsScalar::from_raw([
        0xb64f31a9d567905b,
        0x5f632e1bd97b4e41,
        0x852054b1c6c5c831,
        0x2340ef19bad5e5f0,
    ]),
    BlsScalar::from_raw([
        0x16a9c62baa64f1a3,
        0xd9ed725a6df7f1aa,
        0xc45866bf6da103e7,
        0x55a8a7caacd35ae,
    ]),
    BlsScalar::from_raw([
        0x711a574c556e94d0,
        0xf27a91c548e4c34c,
        0x5a1f2833d01c754a,
        0x16369850ef21665d,
    ]),
    BlsScalar::from_raw([
        0xf73dca12b2381863,
        0xac8f01b998193e4d,
        0x3384dd3d2801a986,
        0x3da1daf1a0778ea2,
    ]),
    BlsScalar::from_raw([
        0xa9278b3eb7ad3db4,
        0xf413ccdc8575721a,
        0xfb1760069a63a012,
        0x4278b893b25df14b,
    ]),
    BlsScalar::from_raw([
        0xe49ec89302d25bd3,
        0xddfe15b8eb7cdde9,
        0xc04ddb626f2c2ac,
        0x3bdc0ba911c2b366,
    ]),
    BlsScalar::from_raw([
        0x4e09a8182e19a4f8,
        0x6be38fea09b7aa16,
        0x36e84cb6e74950ec,
        0x4cabf50f8c3dd4af,
    ]),
    BlsScalar::from_raw([
        0x25cfda8026b3bc47,
        0xb6e079850bce3bec,
        0x1416bc5c7ddea39f,
        0x5ad1422f0274cb35,
    ]),
    BlsScalar::from_raw([
        0x3b8de995b8e5c05e,
        0x27d69a049ee49d7,
        0x626674b98a94f0b5,
        0x5da53bd4cf0f6163,
    ]),
    BlsScalar::from_raw([
        0xc0aacb375fccfc1a,
        0x7f3c8d4fafdc2586,
        0x6894d434cea00039,
        0x130950129948c9d0,
    ]),
    BlsScalar::from_raw([
        0x9397a8b0410e7279,
        0xfb6cefdfd2d70dd2,
        0x9c6d7811db058656,
        0x267640091086e990,
    ]),
    BlsScalar::from_raw([
        0x269cd0bf855870fa,
        0x4531453b50b7de45,
        0xb450b4f7782ecfdf,
        0x2925028c7c8598f4,
    ]),
    BlsScalar::from_raw([
        0x6692fd296b80d42c,
        0x4708ecf28fa451ba,
        0xfd7878be42b47aa0,
        0x33a79a305ffc1b4,
    ]),
    BlsScalar::from_raw([
        0x93b92d24215fef46,
        0x7123e6ac01ab31e4,
        0x99ea301bd92849c1,
        0x10af5080c2ec2d25,
    ]),
    BlsScalar::from_raw([
        0x902d382efb3c8d49,
        0xbbee43fafc2da3ba,
        0xd91aa597ae4348e5,
        0x43ea9d84e81d5f12,
    ]),
    BlsScalar::from_raw([
        0x6d75a44a5455a425,
        0x4525244c5c75fc95,
        0xc978d1f7f5b062c2,
        0x56dea74aa088adbb,
    ]),
    BlsScalar::from_raw([
        0x2c1ca11d38863c74,
        0xd8cb1934096cb8e9,
        0xc25144995a0a2434,
        0x689977f3bc456d01,
    ]),
    BlsScalar::from_raw([
        0xcd674993eb80463d,
        0xa6d3b3f4d50787a9,
        0x5e95aa8136b73f5b,
        0x454a8d5cc896dbf9,
    ]),
    BlsScalar::from_raw([
        0xa37a3aa0f96b0c98,
        0xe7b5f34c00475fe3,
        0x30f68fdb82d0a739,
        0x4e1f25dddea3ba16,
    ]),
    BlsScalar::from_raw([
        0xfb165083855a1451,
        0xf0a6bbcb3f5c081e,
        0x60d42a3e3ee199c7,
        0xefa76e37047ef41,
    ]),
    BlsScalar::from_raw([
        0x6c193a0c71e32d60,
        0x4616f3a5f779e0d8,
        0xbefca7bfdd938c07,
        0x88e6145f9d9b6ee,
    ]),
    BlsScalar::from_raw([
        0x2b594e5240491745,
        0x50e24bd65cf6e562,
        0xe00d7ff13031d0d2,
        0x2cb3290bc1bfd018,
    ]),
    BlsScalar::from_raw([
        0xb93fb8bb874e77ea,
        0xea0acc071b248fa,
        0xb73db19a024d5b35,
        0x3ab80bb9db1c4083,
    ]),
    BlsScalar::from_raw([
        0x4d2b44c8c142450e,
        0x572d805fd4214564,
        0x9e113e1a04c2bb4f,
        0x6b1338ce03fb17d,
    ]),
    BlsScalar::from_raw([
        0xde54f2f6bf69ef39,
        0x6d26c9e6416b9287,
        0xdab1b4fa7f510f5e,
        0x2760a5ab52fb540e,
    ]),
    BlsScalar::from_raw([
        0x92ab5689401e8f4b,
        0xbfe37123bdd068c0,
        0x5a5d132a928b8607,
        0x4def71a67569defd,
    ]),
];

#[derive(Clone, Copy)]
pub struct PoseidonParams {
    pub mds: [[BlsScalar; WIDTH]; WIDTH],
    pub round_constants: &'static [BlsScalar],
    pub full_rounds: usize,
    pub partial_rounds: usize,
    pub half_full_rounds: usize,
    pub domain_tag: BlsScalar,
}

pub fn poseidon_params() -> PoseidonParams {
    PoseidonParams {
        mds: MDS,
        round_constants: &ROUND_CONSTANTS,
        full_rounds: FULL_ROUNDS,
        partial_rounds: PARTIAL_ROUNDS,
        half_full_rounds: HALF_FULL_ROUNDS,
        domain_tag: DOMAIN_TAG_SCALAR,
    }
}

pub fn poseidon_hash2(inputs: [BlsScalar; 2]) -> BlsScalar {
    let mut state = [DOMAIN_TAG_SCALAR, inputs[0], inputs[1]];
    let mut rc_iter = ROUND_CONSTANTS.iter();

    for _ in 0..HALF_FULL_ROUNDS {
        add_round_constants(&mut state, &mut rc_iter);
        sbox_full(&mut state);
        state = mds_mul(&state, &MDS);
    }

    for _ in 0..PARTIAL_ROUNDS {
        add_round_constants(&mut state, &mut rc_iter);
        state[0] = sbox(state[0]);
        state = mds_mul(&state, &MDS);
    }

    for _ in 0..HALF_FULL_ROUNDS {
        add_round_constants(&mut state, &mut rc_iter);
        sbox_full(&mut state);
        state = mds_mul(&state, &MDS);
    }

    state[0]
}

fn add_round_constants<'a>(
    state: &mut [BlsScalar; WIDTH],
    rc_iter: &mut impl Iterator<Item = &'a BlsScalar>,
) {
    for element in state.iter_mut() {
        *element += rc_iter.next().expect("round constants");
    }
}

fn sbox_full(state: &mut [BlsScalar; WIDTH]) {
    for element in state.iter_mut() {
        *element = sbox(*element);
    }
}

fn sbox(x: BlsScalar) -> BlsScalar {
    let x2 = x * x;
    let x4 = x2 * x2;
    x4 * x
}

fn mds_mul(state: &[BlsScalar; WIDTH], mds: &[[BlsScalar; WIDTH]; WIDTH]) -> [BlsScalar; WIDTH] {
    let mut out = [BlsScalar::zero(); WIDTH];
    for i in 0..WIDTH {
        let mut acc = BlsScalar::zero();
        for j in 0..WIDTH {
            acc += mds[i][j] * state[j];
        }
        out[i] = acc;
    }
    out
}
